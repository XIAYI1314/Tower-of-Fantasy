name: Build

on:
    pull_request:
    workflow_dispatch:
        inputs:
          sdk_link:
            description: "Link to SDK (zip file): "
            required: true

jobs:
    build:
        runs-on: windows-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v2

            - name: Download SDK
              run: |
                    $sdk_link = "https://cdn.discordapp.com/attachments/437459134355603458/1224013492802162880/CppSDK.zip?ex=661bf265&is=66097d65&hm=c63c2367f75da77086f47bd02f7ac6192ce956af4e249cf5d330029cf278eec0&"
                    Invoke-WebRequest -Uri $sdk_link -OutFile sdk.zip
                    Expand-Archive -Path sdk.zip -DestinationPath CppSDK

            - name: Set up MSVC environment
              uses: microsoft/setup-msbuild@v2

            - uses: lukka/get-cmake@latest

            - name: Configure CMake
              run: cmake -B build -S .

            - name: Build project
              run: cmake --build build --config Release

            - name: Archive artifacts
              uses: actions/upload-artifact@v2
              with:
                  name: build
                  path: build
